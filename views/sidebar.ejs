<a href="/">
    <h4 class="text-light ms-2 text-center">
      Inventory
      <img src="/images/storage.png" alt="logo" class="img-fluid" style="max-width: 40px; vertical-align: middle;">
    </h4>
  </a>
  
  <% if (user) { %>
    <a href="/"><i class="fa-solid fa-house me-2"></i>Home</a>
    <a href="/transaction" class="text-wrap"><i class="fa-solid fa-right-left me-2"></i>Parts Transaction</a>
    <a href="/onhand"><i class="fa-solid fa-warehouse me-2"></i>Stock on-hand</a>
  
    <% if (user.role === 'admin') { %>
      <a href="/trans-out" class="text-wrap"><i class="fa-solid fa-right-from-bracket me-2"></i>Issue Parts</a>

      <a href="/stock-summary"><i class="fa-solid fa-table-list me-2"></i>Stock Summary</a>

      <a href="/trans-in" class="text-wrap"><i class="fa-solid fa-right-to-bracket me-2"></i>Receive Parts</a>
  
      <div class="dropdown dropend custom-dropdown">
        <a href="#" class="btn dropdown-toggle text-start text-wrap" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="fa-solid fa-screwdriver-wrench me-1"></i>
          <span class="d-inline-block text-break">Manage Parts</span>
        </a>
        <ul class="dropdown-menu dropdown-menu-start" aria-labelledby="dropdownMenuLink">
          <li><a class="dropdown-item ps-3 pe-3" href="/add-product">Add New Parts</a></li>
          <li><a class="dropdown-item ps-3 pe-3" href="/edit-product">Edit / Delete Parts</a></li>
          <li><a class="dropdown-item ps-3 pe-3" href="/import-form">Import Excel for Add/Update Parts</a></li>
        </ul>
      </div>
  
      <a href="/workorder"><i class="fa-solid fa-clipboard-check me-2"></i>Manage Repair Work</a>

      <a href="/stores"><i class="fa-solid fa-store me-2"></i>Manage Stores</a>

      <a href="/requesters"><i class="fa-solid fa-user me-2"></i>Manage Requesters</a>
      
    <% } %>
  
    <!-- Logout -->
    <div class="text-center mt-2">
      <button type="button" class="btn btn-danger" onclick="logoutUser()">
        <i class="fa-solid fa-right-from-bracket me-2"></i> Logout
      </button>
    </div>
  
  <% } else { %>
    <!-- ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ login -->
    <div class="text-center mt-2">
      <button type="button" class="btn btn-success" onclick="loginRedirect()">
        <i class="fa-solid fa-right-to-bracket me-2"></i> Login
      </button>
    </div>
  <% } %>
  
  <!-- Spinner ‡∏ó‡∏î‡∏™‡∏≠‡∏ö -->
<div id="sidebarSpinner" class="mt-3 text-center">
  <div class="spinner-border text-warning" role="status" style="width:2rem;height:2rem;">
    <span class="visually-hidden">Loading...</span>
  </div>
  <div class="small text-warning mt-1">Loading...</div>
</div>

<script>
  // ‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ init ‡∏ã‡πâ‡∏≥ ‡∏ñ‡πâ‡∏≤ sidebar ‡∏ñ‡∏π‡∏Å include ‡∏´‡∏•‡∏≤‡∏¢‡∏à‡∏∏‡∏î (desktop + mobile)
  if (!window.__sidebarSpinnerInit) {
    window.__sidebarSpinnerInit = true;

    const spinnerEl = document.getElementById('sidebarSpinner');

    function showSidebarSpinner() {
      console.log("üîÑ show spinner");
      if (spinnerEl) spinnerEl.classList.remove('d-none');
    }
    function hideSidebarSpinner() {
      console.log("‚úÖ hide spinner");
      if (spinnerEl) spinnerEl.classList.add('d-none');
    }

    // üî∏ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ‡πÉ‡∏´‡πâ spinner ‡πÇ‡∏ä‡∏ß‡πå‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á
    document.addEventListener('DOMContentLoaded', () => {
      showSidebarSpinner();
    });

    // üî∏ ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô)
    window.addEventListener('load', () => {
      setTimeout(() => hideSidebarSpinner(), 500);
    });

    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ jQuery
    if (window.jQuery) {
      $(document).ajaxStart(() => showSidebarSpinner());
      $(document).ajaxStop(() => hideSidebarSpinner());
    }

    window.logoutUser = function() {
      showSidebarSpinner();
      window.location.href = "/logout";
    };

    window.loginRedirect = function() {
      showSidebarSpinner();
      window.location.href = "/login";
    };

    // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ
    window.showSidebarSpinner = showSidebarSpinner;
    window.hideSidebarSpinner = hideSidebarSpinner;
  }
</script>
